var Atrament=function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";t.exports=n(2)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(3),c=i(a);t.exports=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s(this,t),"undefined"==typeof window)throw new Error("Looks like we're not running in a browser");if(e instanceof window.Node&&"CANVAS"===e.tagName)this.canvas=e;else{if("string"!=typeof e)throw new Error("can't look for canvas based on '"+e+"'");this.canvas=document.querySelector(e)}if(!this.canvas)throw new Error("canvas not found");this.canvas.width=i.width||this.canvas.width,this.canvas.height=i.height||this.canvas.height,this.canvas.style.cursor="crosshair",this.mouse=new c.default;var o=function(t){t.cancelable&&t.preventDefault();var e=n.canvas.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]||t,o=i.offsetX,s=i.offsetY;"undefined"==typeof o&&(o=i.clientX-e.left),"undefined"==typeof s&&(s=i.clientY-e.top),n.mouse.down?(n.draw(o,s),n._dirty||o===n.mouse.x&&s===n.mouse.y||(n._dirty=!0,n.fireDirty())):(n.mouse.x=o,n.mouse.y=s)},r=function(t){return t.cancelable&&t.preventDefault(),o(t),"fill"===n._mode?void n.fill():(n.mouse.px=n.mouse.x,n.mouse.py=n.mouse.y,n.mouse.down=!0,n.context.beginPath(),void n.context.moveTo(n.mouse.px,n.mouse.py))},a=function(t){var e=t.changedTouches&&t.changedTouches[0]||t,i=e.offsetX,o=e.offsetY;n.mouse.down=!1,n.mouse.x===i&&n.mouse.y===o&&n.draw(n.mouse.x,n.mouse.y),n.context.closePath()};this.canvas.addEventListener("mousemove",o),this.canvas.addEventListener("mousedown",r),document.addEventListener("mouseup",a),this.canvas.addEventListener("touchstart",r),this.canvas.addEventListener("touchend",a),this.canvas.addEventListener("touchmove",o),this.destroy=function(){n.clear(),n.canvas.removeEventListener("mousemove",o),n.canvas.removeEventListener("mousedown",r),document.removeEventListener("mouseup",a),n.canvas.removeEventListener("touchstart",r),n.canvas.removeEventListener("touchend",a),n.canvas.removeEventListener("touchmove",o)},this.context=this.canvas.getContext("2d"),this.context.globalCompositeOperation="source-over",this.context.globalAlpha=1,this.context.strokeStyle=i.color||"rgba(0,0,0,1)",this.context.lineCap="round",this.context.lineJoin="round",this.context.translate(.5,.5),this._filling=!1,this._fillStack=[],this.SMOOTHING_INIT=.85,this.WEIGHT_SPREAD=10,this._smoothing=this.SMOOTHING_INIT,this._maxWeight=12,this._thickness=2,this._targetThickness=2,this._weight=2,this._mode="draw",this._adaptive=!0,["weight","smoothing","adaptiveStroke","mode","opacity"].forEach(function(t){return void 0===i[t]?0:n[t]=i[t]})}return r(t,[{key:"draw",value:function(e,n){var i=this.mouse,o=this.context,s=t.lineDistance(e,n,i.px,i.py),r=Math.min(.87,this._smoothing+(s-60)/3e3);i.x=e-(e-i.px)*r,i.y=n-(n-i.py)*r;var a=t.lineDistance(i.x,i.y,i.px,i.py);this._adaptive?(this._targetThickness=(a-1)/49*(this._maxWeight-this._weight)+this._weight,this._thickness>this._targetThickness?this._thickness-=.5:this._thickness<this._targetThickness&&(this._thickness+=.5),o.lineWidth=this._thickness):o.lineWidth=this._weight,o.quadraticCurveTo(i.px,i.py,i.x,i.y),o.stroke(),i.px=i.x,i.py=i.y}},{key:"fireDirty",value:function(){var t=document.createEvent("Event");t.initEvent("dirty",!0,!0),this.canvas.dispatchEvent(t)}},{key:"clear",value:function(){this.dirty&&(this._dirty=!1,this.fireDirty(),"destination-out"===this.context.globalCompositeOperation?(this.mode="draw",this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20),this.mode="erase"):this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20))}},{key:"toImage",value:function(){return this.canvas.toDataURL()}},{key:"fill",value:function(){var t=this,e=this.mouse,n=this.context,i=Array.prototype.slice.call(n.getImageData(e.x,e.y,1,1).data,0);this._filling?this._fillStack.push([e.x,e.y,i]):(this.canvas.style.cursor="progress",this._filling=!0,setTimeout(function(){t._floodFill(e.x,e.y,i)},100))}},{key:"_floodFill",value:function(e,n,i){var s=this,r=this.context,a=Math.floor(e),c=Math.floor(n),h=r.canvas.width,u=r.canvas.height,l=[[a,c]],f=t.hexToRgb(this.color),p=r.getImageData(0,0,r.canvas.width,r.canvas.height),d=Math.min(10*r.globalAlpha*255,255),v=t.colorPixel.apply(t,[p.data].concat(o(f),[i,d])),y=t.matchColor.apply(t,[p.data].concat(o(i))),g=t.matchColor.apply(t,[p.data].concat([].concat(o(f),[255])));if(g(4*(c*r.canvas.width+a)))return this._filling=!1,void setTimeout(function(){s.canvas.style.cursor="crosshair"},100);for(;l.length;){for(var m=l.pop(),_=m[0],w=m[1],x=4*(w*h+_);w-- >=0&&y(x);)x-=4*h;x+=4*h,++w;for(var k=!1,b=!1;w++<u-1&&y(x);)v(x),_>0&&(y(x-4)?k||(l.push([_-1,w]),k=!0):k&&(k=!1)),_<h-1&&(y(x+4)?b||(l.push([_+1,w]),b=!0):b&&(b=!1)),x+=4*h}r.putImageData(p,0,0),this._fillStack.length?this._floodFill.apply(this,o(this._fillStack.shift())):(this._filling=!1,setTimeout(function(){s.canvas.style.cursor="crosshair"},100))}},{key:"color",get:function(){return this.context.strokeStyle},set:function(t){if("string"!=typeof t)throw new Error("wrong argument type");this.context.strokeStyle=t}},{key:"weight",get:function(){return this._weight},set:function(t){if("number"!=typeof t)throw new Error("wrong argument type");this._weight=t,this._thickness=t,this._targetThickness=t,this._maxWeight=t+this.WEIGHT_SPREAD}},{key:"adaptiveStroke",get:function(){return this._adaptive},set:function(t){this._adaptive=!!t}},{key:"mode",get:function(){return this._mode},set:function(t){if("string"!=typeof t)throw new Error("wrong argument type");switch(t){case"erase":this._mode="erase",this.context.globalCompositeOperation="destination-out";break;case"fill":this._mode="fill",this.context.globalCompositeOperation="source-over";break;default:this._mode="draw",this.context.globalCompositeOperation="source-over"}}},{key:"dirty",get:function(){return!!this._dirty}},{key:"smoothing",get:function(){return this._smoothing===this.SMOOTHING_INIT},set:function(t){if("boolean"!=typeof t)throw new Error("wrong argument type");this._smoothing=t?this.SMOOTHING_INIT:0}},{key:"opacity",set:function(t){if("number"!=typeof t)throw new Error("wrong argument type");t>=1?this.context.globalAlpha=1:this.context.globalAlpha=t/10}}],[{key:"lineDistance",value:function(t,e,n,i){var o=Math.pow(n-t,2),s=Math.pow(i-e,2);return Math.sqrt(o+s)}},{key:"hexToRgb",value:function(t){var e=t.match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{key:"matchColor",value:function(t,e,n,i,o){return function(s){var r=t[s],a=t[s+1],c=t[s+2],h=t[s+3];return r===e&&a===n&&c===i&&h===o}}},{key:"colorPixel",value:function(e,n,i,s,r,a){var c=t.matchColor.apply(t,[e].concat(o(r)));return function(t){e[t]=n,e[t+1]=i,e[t+2]=s,e[t+3]=a,c(t+4)||(e[t+4]=.01*e[t+4]+.99*n,e[t+4+1]=.01*e[t+4+1]+.99*i,e[t+4+2]=.01*e[t+4+2]+.99*s,e[t+4+3]=.01*e[t+4+3]+.99*a),c(t-4)||(e[t-4]=.01*e[t-4]+.99*n,e[t-4+1]=.01*e[t-4+1]+.99*i,e[t-4+2]=.01*e[t-4+2]+.99*s,e[t-4+3]=.01*e[t-4+3]+.99*a)}}}]),t}()},function(t,e){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,n){o(this,t),this._x=e,this._y=n}return s(t,[{key:"set",value:function(t,e){this._x=t,this._y=e}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}}]),t}(),a=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,0,0));return t._down=!1,t._px=0,t._py=0,t}return i(e,t),s(e,[{key:"down",get:function(){return this._down},set:function(t){this._down=t}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"px",get:function(){return this._px},set:function(t){this._px=t}},{key:"py",get:function(){return this._py},set:function(t){this._py=t}}]),e}(r);e.default=a}]);
//# sourceMappingURL=atrament.min.js.map